#!/usr/bin/env bash

set -e

export PIO_HOME="$(cd `dirname $0`/..; pwd)"

ASSEMBLY_DIR="$PIO_HOME/assembly"

if [ -f "$PIO_HOME/RELEASE" ]; then
  assembly_folder="$FWDIR"/lib
else
  assembly_folder="$ASSEMBLY_DIR"
fi

ASSEMBLY_JAR=$(ls "$assembly_folder"/tools-assembly*.jar 2>&-)

$PIO_HOME/bin/pio-class io.prediction.tools.RunWorkflow --core $ASSEMBLY_JAR "$@"

echo "Reloading prediction server at http://localhost:8000 if one exists..."
curl http://localhost:8000/reload
